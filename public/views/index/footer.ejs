<script async type="module">

import { DiscordSDK } from "https://unpkg.com/@discord/embedded-app-sdk@1.0.0/output/index.mjs";

const clientID = "1219982523761954917";
const clientSecret = "zJa3hOQuhyAKLulWtdcnA_QlhXKljZju";

const discordSdk = new DiscordSDK(clientID);

async function setup() {
    await discordSdk.ready();

    const {code} = await discordSdk.commands.authorize({
        client_id: clientID,
        response_type: 'code',
        state: '',
        prompt: 'consent',
        ''
        scope: ['identify','guilds','rpc.voice.read','email','connections','guilds.members.read','rpc.activities.write'],
    });
    const response = await fetch(`/auth/discord/callback?code=` + code);

    const {access_token} = await response.json()

    const auth = await discordSdk.commands.authenticate({
        access_token,
    });

    window.discordAuth = auth;
    await discordSdk.commands.encourageHardwareAcceleration();
/*        await discordSdk.commands.setActivity({
        activity: {
            type: 0,
            details: 'Exploring the world',
            state: 'Playing Traveler',
            assets: {
                large_image: "embedded_cover",
                large_text: "Traveler",
                small_image: "world00-lostisland",
                small_text: "Playing Traveler"
            }
        },
    });*/
}

await setup();
</script>

<%- include('../build/cover-pack-scripts') %>
